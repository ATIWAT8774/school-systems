<!doctype html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <title>แดชบอร์ด - M - SMART</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- ฟอนต์ -->
    <link
      href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />

    <!-- CSS หลัก -->
    <link rel="stylesheet" href="styles.css" />

    <!-- JS หลัก -->
    <script src="app.js" defer></script>
  </head>
  <body class="app-body">
    <!-- Dashboard -->
    <div id="dashboard" class="dashboard">
      <div class="top-bar">
        <div class="system-info">
          <img src="logo.png" alt="ตราโรงเรียน" class="top-bar-logo" />

          <div>
            <h1 id="dashboardSystemTitle">
              M - SMART
            </h1>
            <p id="dashboardSchoolName">โรงเรียนบ้านหนองระแวง</p>
          </div>
        </div>

        <div class="user-info">
          <div class="user-details">
            <p class="user-name" id="currentUserName">ผู้ใช้งาน</p>
            <p class="user-role" id="currentUserRole">สถานะ</p>
          </div>
          <button class="logout-btn" id="logoutBtn">ออกจากระบบ</button>
        </div>
      </div>

      <div class="marquee-container">
        <div class="marquee-text" id="marqueeText">
          ยินดีต้อนรับสู่ระบบติดตามงานของผู้อำนวยการสถานศึกษา
          โรงเรียนบ้านหนองระแวง
        </div>
      </div>

      <div class="main-content">

        <h3 class="section-title">บอร์ดประชาสัมพันธ์</h3>
        <div id="dashboardAnnouncements" class="announcements-board">
          </div>

        <h3 class="section-title">แดชบอร์ด</h3>
        <div class="cards-grid" id="dashboardCards">
          </div>
      </div>
    </div>

    <!-- Assign Task Modal -->
    <div id="assignTaskModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title">มอบหมายงาน</h2>
          <button class="close-btn" data-close-modal="assignTaskModal">×</button>
        </div>

        <form id="assignTaskForm">
          <div class="form-group">
            <label>ชื่องาน</label>
            <input type="text" id="taskTitle" required />
          </div>

          <div class="form-group">
            <label>รายละเอียด</label>
            <textarea
              id="taskDescription"
              rows="3"
              required
              class="textarea"
            ></textarea>
          </div>

          <div class="form-group">
            <label>กำหนดส่ง</label>
            <input type="date" id="taskDeadline" required />
          </div>

          <div class="form-group">
            <label>ระดับความสำคัญ</label>
            <select id="taskPriority" required>
              <option value="">เลือกระดับความสำคัญ</option>
              <option value="high">สูง</option>
              <option value="medium">ปานกลาง</option>
              <option value="low">ต่ำ</option>
            </select>
          </div>

          <div class="form-group">
            <label>เลือกฝ่าย</label>
            <select id="taskDepartment" required>
              <option value="">เลือกฝ่าย</option>
              <option value="budget">ฝ่ายงบประมาณ</option>
              <option value="general">ฝ่ายบริหารทั่วไป</option>
              <option value="academic">ฝ่ายวิชาการ</option>
              <option value="personnel">ฝ่ายบุคลากร</option>
            </select>
          </div>

          <div class="form-group">
            <label>เลือกผู้รับผิดชอบ</label>
            <div id="teacherList" class="teacher-list"></div>
          </div>

          <div class="button-group">
            <button type="submit" class="btn btn-primary" id="assignTaskBtn">
              มอบหมายงาน
            </button>
            <button
              type="button"
              class="btn btn-secondary"
              data-close-modal="assignTaskModal"
            >
              ยกเลิก
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Track Tasks Modal -->
    <div id="trackTasksModal" class="modal">
      <div class="modal-content modal-wide">
        <div class="modal-header">
          <h2 class="modal-title">ติดตามงาน</h2>
          <button class="close-btn" data-close-modal="trackTasksModal">×</button>
        </div>

        <div class="filter-bar">
          <select id="statusFilter">
            <option value="">ทุกสถานะ</option>
            <option value="pending">รอดำเนินการ</option>
            <option value="in_progress">กำลังดำเนินการ</option>
            <option value="completed">เสร็จสิ้น</option>
            <option value="overdue">เกินกำหนด</option>
          </select>

          <select id="departmentFilter">
            <option value="">ทุกฝ่าย</option>
            <option value="budget">ฝ่ายงบประมาณ</option>
            <option value="general">ฝ่ายบริหารทั่วไป</option>
            <option value="academic">ฝ่ายวิชาการ</option>
            <option value="personnel">ฝ่ายบุคลากร</option>
          </select>
        </div>

        <div id="tasksList" class="tasks-list"></div>
      </div>
    </div>

    <!-- Task Detail Modal -->
    <div id="taskDetailModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title">รายละเอียดงาน</h2>
          <button class="close-btn" data-close-modal="taskDetailModal">×</button>
        </div>

        <div id="taskDetailContent"></div>
        <div class="button-group" id="taskActions"></div>
      </div>
    </div>

    <!-- Announcements Modal -->
    <div id="announcementsModal" class="modal">
      <div class="modal-content modal-wide">
        <div class="modal-header">
          <h2 class="modal-title">ประกาศ</h2>
          <button class="close-btn" data-close-modal="announcementsModal">
            ×
          </button>
        </div>

        <div class="modal-toolbar">
          <button class="btn btn-primary" id="btnShowAddAnnouncement">
            เพิ่มประกาศใหม่
          </button>
        </div>

        <div id="addAnnouncementForm" class="panel-form hidden">
          <form id="announcementForm">
            <div class="form-group">
              <label>หัวข้อประกาศ</label>
              <input type="text" id="announcementTitle" required />
            </div>

            <div class="form-group">
              <label>เนื้อหา</label>
              <textarea
                id="announcementMessage"
                rows="4"
                required
                class="textarea"
              ></textarea>
            </div>

            <div class="button-group">
              <button type="submit" class="btn btn-primary">
                เผยแพร่ประกาศ
              </button>
              <button
                type="button"
                class="btn btn-secondary"
                id="btnHideAddAnnouncement"
              >
                ยกเลิก
              </button>
            </div>
          </form>
        </div>

        <div id="announcementsList"></div>
      </div>
    </div>

    <!-- Problems Modal -->
    <div id="problemsModal" class="modal">
      <div class="modal-content modal-wide">
        <div class="modal-header">
          <h2 class="modal-title">แจ้งปัญหา</h2>
          <button class="close-btn" data-close-modal="problemsModal">×</button>
        </div>

        <div class="modal-toolbar">
          <button class="btn btn-primary" id="btnShowReportProblem">
            แจ้งปัญหาใหม่
          </button>
        </div>

        <div id="reportProblemForm" class="panel-form hidden">
          <form id="problemForm">
            <div class="form-group">
              <label>หมวดหมู่ปัญหา</label>
              <select id="problemCategory" required>
                <option value="">เลือกหมวดหมู่</option>
                <option value="system">ระบบ</option>
                <option value="work">งาน</option>
                <option value="equipment">อุปกรณ์</option>
                <option value="other">อื่นๆ</option>
              </select>
            </div>

            <div class="form-group">
              <label>รายละเอียดปัญหา</label>
              <textarea
                id="problemMessage"
                rows="4"
                required
                class="textarea"
              ></textarea>
            </div>

            <div class="button-group">
              <button type="submit" class="btn btn-primary">ส่งรายงาน</button>
              <button
                type="button"
                class="btn btn-secondary"
                id="btnHideReportProblem"
              >
                ยกเลิก
              </button>
            </div>
          </form>
        </div>

        <div id="problemsList"></div>
      </div>
    </div>

    <!-- Calendar Modal -->
    <div id="calendarModal" class="modal">
      <div class="modal-content modal-wide">
        <div class="modal-header">
          <h2 class="modal-title">ปฏิทินงาน</h2>
          <button class="close-btn" data-close-modal="calendarModal">×</button>
        </div>

        <div class="calendar-toolbar">
          <div class="calendar-nav">
            <button class="btn btn-secondary" id="btnPrevMonth">
              ‹ เดือนก่อน
            </button>
            <h3 id="currentMonth" class="calendar-month"></h3>
            <button class="btn btn-secondary" id="btnNextMonth">
              เดือนถัดไป ›
            </button>
          </div>

          <button class="btn btn-primary" id="btnToday">วันนี้</button>
        </div>

        <div id="calendar" class="calendar-grid"></div>

        <div class="upcoming-wrapper">
          <h4>งานที่กำลังจะถึงกำหนด</h4>
          <div id="upcomingTasks"></div>
        </div>
      </div>
    </div>

    <!-- Reports Modal -->
    <div id="reportsModal" class="modal">
      <div class="modal-content modal-wide">
        <div class="modal-header">
          <h2 class="modal-title">รายงานสรุป</h2>
          <button class="close-btn" data-close-modal="reportsModal">×</button>
        </div>

        <div class="reports-dashboard">
          <div class="stats-grid">
            <div class="stat-card stat-total">
              <div id="totalTasks" class="stat-number">0</div>
              <div class="stat-label">งานทั้งหมด</div>
            </div>
            <div class="stat-card stat-pending">
              <div id="pendingTasks" class="stat-number">0</div>
              <div class="stat-label">รอดำเนินการ</div>
            </div>
            <div class="stat-card stat-inprogress">
              <div id="inProgressTasks" class="stat-number">0</div>
              <div class="stat-label">กำลังดำเนินการ</div>
            </div>
            <div class="stat-card stat-completed">
              <div id="completedTasks" class="stat-number">0</div>
              <div class="stat-label">เสร็จสิ้น</div>
            </div>
            <div class="stat-card stat-overdue">
              <div id="overdueTasks" class="stat-number">0</div>
              <div class="stat-label">เกินกำหนด</div>
            </div>
          </div>

          <div class="reports-rows">
            <div class="reports-panel">
              <h4>สถิติตามฝ่าย</h4>
              <div id="departmentStats"></div>
            </div>

            <div class="reports-panel">
              <h4>ประสิทธิภาพการทำงาน</h4>
              <div id="performanceStats"></div>
            </div>
          </div>

          <div class="reports-panel">
            <h4>งานที่เกินกำหนด</h4>
            <div id="overdueTasksList"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Users Management Modal -->
    <div id="usersModal" class="modal">
      <div class="modal-content modal-wide">
        <div class="modal-header">
          <h2 class="modal-title">จัดการผู้ใช้งาน</h2>
          <button class="close-btn" data-close-modal="usersModal">×</button>
        </div>

        <div class="modal-toolbar">
          <button class="btn btn-primary" id="btnShowAddUser">
            เพิ่มผู้ใช้ใหม่
          </button>
        </div>

        <div id="addUserForm" class="panel-form hidden">
          <form id="userForm">
            <div class="two-columns">
              <div class="form-group">
                <label>ชื่อผู้ใช้</label>
                <input type="text" id="newUsername" required />
              </div>
              <div class="form-group">
                <label>รหัสผ่าน</label>
                <input type="password" id="newPassword" required />
              </div>
              <div class="form-group">
                <label>ชื่อ-นามสกุล</label>
                <input type="text" id="newFullName" required />
              </div>
              <div class="form-group">
                <label>สถานะ</label>
                <select id="newRole" required>
                  <option value="">เลือกสถานะ</option>
                  <option value="admin">ผู้ดูแลระบบ</option>
                  <option value="director">ผู้อำนวยการ</option>
                  <option value="head_budget">หัวหน้าฝ่ายงบประมาณ</option>
                  <option value="head_general">หัวหน้าฝ่ายบริหารทั่วไป</option>
                  <option value="head_academic">หัวหน้าฝ่ายวิชาการ</option>
                  <option value="head_personnel">หัวหน้าฝ่ายบุคลากร</option>
                  <option value="teacher_budget">ครูฝ่ายงบประมาณ</option>
                  <option value="teacher_general">
                    ครูฝ่ายบริหารทั่วไป
                  </option>
                  <option value="teacher_academic">ครูฝ่ายวิชาการ</option>
                  <option value="teacher_personnel">
                    ครูฝ่ายบุคลากร
                  </option>
                </select>
              </div>
            </div>

            <div class="button-group">
              <button type="submit" class="btn btn-primary">เพิ่มผู้ใช้</button>
              <button
                type="button"
                class="btn btn-secondary"
                id="btnHideAddUser"
              >
                ยกเลิก
              </button>
            </div>
          </form>
        </div>

        <div id="usersList"></div>
      </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast">
      <span id="toastMessage"></span>
    </div>
  </body>
</html>
